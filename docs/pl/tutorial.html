<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><!--This page is automatically generated.  Do not edit!-->
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Nutch: Podręcznik</title>
<style type="text/css">
.menuTd {background-color: #F9F7F4; height: 25; onMouseOver: this.style.backgroundColor='#ECE5DC';}
.menuTdhover {background-color: #ECE5DC; height: 25; onMouseOver: this.style.backgroundColor='#ECE5DC';}
.menuEntry {  font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #000000; text-decoration: none}
.body {background-color: #F9F7F4;}
.bodytext {  font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #000000; text-decoration: none}
.title {  font-family: Arial, Helvetica, sans-serif; font-size: 26px; color: #FF9900; text-decoration: none}
.intro {  font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #FF9900; text-decoration: none}
.orangeTd {background-color: #FF9900}
ul {list-style-image: url(../img/reiter/ul.gif)}
h3 {font-family: Arial, Helvetica, sans-serif; font-size: 16px; color: #000000;}
h4 {font-family: Arial, Helvetica, sans-serif; font-size: 14px; color: #000000;}
.url {color: #996600;}
</style>
<link type="image/x-icon" href="../img/favicon.ico" rel="icon">
<link type="image/x-icon" href="../img/favicon.ico" rel="shortcut icon">
</head>
<body>
<!--This file is automatically generated.  Do not edit!-->
<table cellspacing="0" cellpadding="0" border="0" width="635">
<tr>
<td rowspan="2" width="140" valign="bottom"><a href="./"><img border="0" src="../img/reiter/logo_nutch.gif"></a><img height="1" width="140" src="../img/reiter/spacer_666666.gif"></td>
</tr>
<tr>
<td align="right" valign="bottom" width="495">
<table width="495" cellspacing="0" cellpadding="0" border="0">
<tr>
<td width="400" background="../img/reiter/_bg_reiter.gif">&nbsp;</td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_le1.gif"></td><td nowrap="nowrap" valign="bottom" background="../img/reiter/_bg_reiter_inactive.gif"><a href="about.html" class="bodytext">O Nutch</a></td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_ri.gif"></td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_le.gif"></td><td nowrap="nowrap" valign="bottom" background="../img/reiter/_bg_reiter_inactive.gif"><a href="faq.html" class="bodytext">Częste pytania</a></td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_ri.gif"></td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_le.gif"></td><td nowrap="nowrap" valign="bottom" background="../img/reiter/_bg_reiter_inactive.gif"><a href="developers.html" class="bodytext">Deweloperzy</a></td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_ri.gif"></td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_le.gif"></td><td nowrap="nowrap" valign="bottom" background="../img/reiter/_bg_reiter_inactive.gif"><a href="donate.html" class="bodytext">Darowizny</a></td><td width="10" valign="bottom" height="28"><img border="0" src="../img/reiter/reiter_inactive_ri.gif"></td>
</tr>
</table>
</td>
</tr>
</table>
<table cellspacing="0" cellpadding="0" border="0" width="635">
<tr valign="top">
<td width="140">
<table cellspacing="0" cellpadding="0" width="100%">
<tr>
<td>&#160;</td>
</tr>
</table>
</td><td background="../img/reiter/_spacer_cccccc.gif" width="20">&#160;</td><td class="body" width="475">
<table cellspacing="0" cellpadding="0" border="0" width="475">
<tr>
<td valign="bottom" width="275" height="125" class="title">Podręcznik</td><td valign="bottom" width="200" height="125"><img src="../img/reiter/robots.gif"></td>
</tr>
</table>
<br class="br">
<span class="bodytext">

</span><span class="bodytext">
<h3>Wymagania</h3>
</span><span class="bodytext">
</span><span class="bodytext">
<ol>
  
<li>Zalecane jest użycie Java 1.4.x, wersji <a href="http://java.sun.com/j2se/downloads.html">Sun</a> lub <a href="http://www-106.ibm.com/developerworks/java/jdk/">IBM</a> dla
 platformy Linux.  Ustaw zmienną środowiskową <code>NUTCH_JAVA_HOME</code> tak,
 żeby wskazywała na katalog gł&oacute;wny instalacji Java.
  </li>
  
<li>Apache <a href="http://jakarta.apache.org/tomcat/">Tomcat</a>
4.x.</li>
  
<li>Dla platformy Win32, środowisko <a href="http://www.cygwin.com/">Cygwin</a>,
  potrzebne ze względu na powłokę poleceń. (Jeśli planujesz używać CVS z pakietu
  Cygwin, nie zapomnij zaznaczyć CVS i OpenSSH podczas instalacji. Zajdują się one
  w kategoriach "Devel" i "Net").</li>
  
<li>Około gigabajta wolnej przestrzeni dyskowej, szybki dostęp do Internetu,
  i około jednej godziny.
  </li>

</ol>
</span><span class="bodytext">
</span><span class="bodytext">
<h3>Zaczynamy</h3>
</span><span class="bodytext">
</span><span class="bodytext">
<p>Po pierwsze, musisz uzyskać kopię kodu Nutch. Możesz ściągnąć oficjalną
wersję z  <a href="http://www.nutch.org/release/">http://www.nutch.org/release/</a>.
Rozpakuj archiwum i przejdź do gł&oacute;wnego katalogu dystrybucji. Możesz r&oacute;wnież
wziąć kod źr&oacute;dłowy z <a href="http://sourceforge.net/cvs/?group_id=59548">CVS</a>
i skompilować wersję binarną przy użyciu <a href="http://ant.apache.org/">Ant</a>.</p>
</span><span class="bodytext">

</span><span class="bodytext">
<p>Następnie wykonaj następujące polecenie:</p>
</span><span class="bodytext">
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch</pre>
</span><span class="bodytext">
Wyświetli ono dokumentację skryptu poleceń Nutch.

</span><span class="bodytext">
<p>Teraz jesteśmy gotowi do pobierania stron ("crawling"). Istnieją dwa warianty
pobierania:
<ol>

<li>Pobieranie z intranetu, przy pomocy polecenia <code>crawl</code>.</li>

<li>Pobieranie z całej sieci Internet, gdzie ma się więcej kontroli nad procesem, i przy
użyciu poleceń niższego poziomu: <code>inject</code>, <code>generate</code>, <code>fetch</code>
oraz <code>updatedb</code>.</li>

</ol>

</p>
</span><span class="bodytext">

</span><span class="bodytext">
<h3>Pobieranie z intranetu</h3>
</span><span class="bodytext">

</span><span class="bodytext">
<p>Ten spos&oacute;b pobierania jest właściwszy wtedy, gdy planujemy pobrać nie więcej niż
około 1 miliona stron pochodzących z kilku serwer&oacute;w.</p>
</span><span class="bodytext">

</span><span class="bodytext">
<h4>Intranet: Konfiguracja</h4>
</span><span class="bodytext">

W celu poprawnej konfiguracji dla pobierania z intranetu musisz:

</span><span class="bodytext">
<ol>


<li>Utworzyć plik tekstowy zawierający listę gł&oacute;wnych odnośnik&oacute;w URL.
Na przykład, żeby pobrać strony z serwera <code>nutch.org</code> możesz utworzyć
plik o nazwie <code>urls</code> zawierający wyłącznie odnośnik do strony domowej. 
Wszystkie pozostałe strony powinny być powiązane z tą stroną. A zatem plik <code>urls</code>
wyglądałby następująco:

<pre>
http://www.nutch.org/
</pre>

</li>


<li>Otworzyć plik <code>conf/crawl-urlfilter.txt</code> w edytorze i
zamienić tekst <code>MY.DOMAIN.NAME</code> na nazwę domeny, z kt&oacute;rej chcesz pobierać
strony. Na przykład, jeśli chcesz ograniczyć pobieranie to domeny <code>nutch.org</code>,
to odpowiedni wiersz pliku powininen wyglądać tak:
<pre>
+^http://([a-z0-9]*\.)*nutch.org/
</pre>
To wyrażenie pasuje do dowolnego odnośnika z domeny <code>nutch.org</code>.
</li>


</ol>
</span><span class="bodytext">

</span><span class="bodytext">
<h4>Intranet: Uruchomienie pobierania</h4>
</span><span class="bodytext">

Po dokonaniu konfiguracji uruchomienie pobierania jest łatwe. Po prostu
użyj polecenia "crawl". Można podać następujące opcje:

</span><span class="bodytext">
<ul>

<li>
<code>-dir</code> <i>dir</i> nazwa katalogu, gdzie zostanie umieszczony wynik.</li>

<li>
<code>-depth</code> <i>depth</i> wskazuje maksymalny poziom zagłębienia odnośnik&oacute;w do stron, kt&oacute;re
mają zostać pobrane, liczony od strony gł&oacute;wnej.</li>

<li>
<code>-delay</code> <i>delay</i> ustala liczbę sekund pomiędzy kolejnymi pobraniami z
tego samego serwera.</li>

<li>
<code>-threads</code> <i>threads</i> ustala liczbę wątk&oacute;w, kt&oacute;re będą r&oacute;wnolegle pobierać strony.</li>

</ul>
</span><span class="bodytext">

Na przykład typowe wywołanie może wyglądać następująco:

</span><span class="bodytext">
<pre>
bin/nutch crawl urls -dir crawl.test -depth 3 &gt;&amp; crawl.log
</pre>
</span><span class="bodytext">

Zazwyczaj uruchamia się pobieranie najpierw na pr&oacute;bę, z małymi wartościami parametru "depth",
żeby sprawdzić czy pobierane są właściwe strony. Kiedy już upewnimy się, że
konfiguracja jest prawidłowa, to stosowna wielkość tego parametru dla pełnego pobierania
wynosi około 10.

</span><span class="bodytext">
<p>Kiedy pobieranie zostanie już zakończone, przejdź do części "Wyszukiwanie" znajdującej się
dalej.</p>
</span><span class="bodytext">

</span><span class="bodytext">
<h3>Pobieranie z całej sieci Internet</h3>
</span><span class="bodytext">

Pobieranie z całej sieci zostało zaprojektowane tak, aby m&oacute;c obsłużyć duże ilości
pobieranych stron, gdzie proces pobierania może trwać tygodniami i działać na wielu
maszynach jednocześnie.

</span><span class="bodytext">
<h4>Internet: Gł&oacute;wne pojęcia</h4>
</span><span class="bodytext">
Nutch przechowuje dane dw&oacute;ch rodzaj&oacute;w:
</span><span class="bodytext">
<ol>
  
<li>Baza stron WWW (WebDB).  Zawiera ona informacje o wszystkich
  stronach znanych wyszukiwarce, oraz o połączeniach pomiędzy nimi.</li>
  
<li>Zestaw segment&oacute;w danych. Segment jest to kolekcja stron WWW, pobranych
  i zindeksowanych jako jeden zestaw. Segment zawiera następujące rodzaje danych:</li>
  
<ul>
    
<li>
<i>fetchlist</i> to plik opisujący zestaw stron do pobrania</li>
    
<li>
<i>fetcher output</i> to zestaw plik&oacute;w zawierający treść pobranych stron</li>
    
<li>
<i>index </i> zawiera pełnotekstowy indeks stron w formacie Lucene.</li>
  
</ul>

</ol>
</span><span class="bodytext">
W przykładach poniżej nasza baza stron WWW będzie się znajdować w katalogu
</span><span class="bodytext"><tt>db</tt></span><span class="bodytext">, a nasze segmenty danych będą w katalogu </span><span class="bodytext"><tt>segments</tt></span><span class="bodytext">:
</span><span class="bodytext">
<pre style="margin-left: 40px;">mkdir db
mkdir segments</pre>
</span><span class="bodytext">

</span><span class="bodytext">
<h4>Internet Inicjalizacja Bazy Stron WWW</h4>
</span><span class="bodytext">
Do utworzenia nowej, pustej bazy, stosujemy narzędzie administracyjne:
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch admin db -create</pre>
</span><span class="bodytext">
Narzędzie </span><span class="bodytext"><i>Injector</i></span><span class="bodytext"> dodaje adresy stron do bazy danych.  Dodajmy adresy
pochodzące z katalogu </span><span class="bodytext"><a href="http://dmoz.org/">DMOZ</a></span><span class="bodytext"> - Open Directory.
Najpierw musimy ściągnąć i rozpakować plik zawierający listę wszystkich stron
skatalogowanych w DMOZ. (Plik ten ma ponad 200MB, więc zajmie to parę minut.)
</span><span class="bodytext">
<pre style="margin-left: 40px;">wget http://rdf.dmoz.org/rdf/content.rdf.u8.gz
gunzip content.rdf.u8.gz</pre>
</span><span class="bodytext">
Następnie dodamy losowo wybrany podzbi&oacute;r tych stron to naszej bazy.
(Używamy losowej pr&oacute;bki, żeby wszyscy ci co postępują według tego podręcznika nie
obciążali tych samych serwer&oacute;w.) Katalog DMOZ zawiera około 3 milion&oacute;w adres&oacute;w.
Dodamy jeden na 3000, więc w rezultacie otrzymamy około 1000 adres&oacute;w:
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch inject db -dmozfile content.rdf.u8 -subset 3000</pre>
</span><span class="bodytext">
Ten krok r&oacute;wnież zabiera kilka minut, ponieważ cały plik musi zostać przetworzony.

</span><span class="bodytext">
<p>W rezultacie otrzymamy bazę stron WWW zawierającą około 1000 adres&oacute;w jeszcze
nie pobranych stron.</p>
</span><span class="bodytext">

</span><span class="bodytext">
<h4>Internet: Pobieranie</h4>
</span><span class="bodytext">
W celu ropozczęcia pobierania najpierw musimy na podstawie bazy stron utworzyć
listę adres&oacute;w do pobrania (tzw. "fetchlist"):
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch generate db segments
</pre>
</span><span class="bodytext">
To polecenie tworzy listę stron do pobrania. Lista ta zostaje umieszczona w
nowo utworzonym katalogu segment&oacute;w. Katalog ten otrzymuje nazwę reprezentującą
czas utworzenia listy. Zachowamy nazwę tego katalogu w zmiennej środowiskowej:
</span><span class="bodytext"><tt>&gt;s1</tt></span><span class="bodytext">:
</span><span class="bodytext">
<pre style="margin-left: 40px;">s1=`ls -d segments/2* | tail -1`
echo $s1
</pre>
</span><span class="bodytext">
Teraz możemy uruchomić proces pobierania tego segmentu przy pomocy polecenia:
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch fetch $s1</pre>
</span><span class="bodytext">
Kiedy ten proces się zakończy, uaktualniamy bazę stron na podstawie rezultat&oacute;w
pobierania:
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch updatedb db $s1</pre>
</span><span class="bodytext">
W tym momencie w bazie danych znajdą się dane na temat wszystkich stron
połączonych odnośnikami do stron pochodzących z początkowego zestawu.

</span><span class="bodytext">
<p>Następnie uruchamiamy pięciokrotną analizę bazy w celu ustalenia priorytet&oacute;w
stron, kt&oacute;re powinny być pobrane w następnej kolejności:</p>
</span><span class="bodytext">
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch analyze db 5
</pre>
</span><span class="bodytext">
Następnie tworzymy nowy segment z listą 1000 stron do pobrania, kt&oacute;re uzyskały
najwyższy priorytet:
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch generate db segments -topN 1000
s2=`ls -d segments/2* | tail -1`
echo $s2

bin/nutch fetch $s2
bin/nutch updatedb db $s2
bin/nutch analyze db 2
</pre>
</span><span class="bodytext">
Pobierzmy w ten sam spos&oacute;b jeszcze raz następne 1000 stron:
</span><span class="bodytext">
<pre style="margin-left: 40px;">
bin/nutch generate db segments -topN 1000
s3=`ls -d segments/2* | tail -1`
echo $s3

bin/nutch fetch $s3
bin/nutch updatedb db $s3
bin/nutch analyze db 2</pre>
</span><span class="bodytext">
Do tego momemntu pobraliśmy już parę tysięcy stron. Utw&oacute;rzmy więc ich indeks.

</span><span class="bodytext">
<h4>Internet: Indeksowanie</h4>
</span><span class="bodytext">
W celu utworzenia indeksu </span><span class="bodytext"><tt>index</tt></span><span class="bodytext"> dla każdego segmentu, stosujemy
następujące polecenie:
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch index $s1
bin/nutch index $s2
bin/nutch index $s3</pre>
</span><span class="bodytext">
Następnie, zanim zaczniemy używać indeks&oacute;w do wyszukiwania, musimy usunąć z niego
duplikaty stron. Robimy to tak:
</span><span class="bodytext">
<pre style="margin-left: 40px;">bin/nutch dedup segments dedup.tmp</pre>
</span><span class="bodytext">
Teraz jesteśmy gotowi do wyszukiwania!

</span><span class="bodytext">
<h3>Wyszukiwanie</h3>
</span><span class="bodytext">

</span><span class="bodytext">
<p>Zanim będziesz m&oacute;gł wyszukiwać, musisz umieścić archiwum WAR w odpowiednim
katalogu twojego serwera servlet-&oacute;w. (Jeśli używałeś kodu z CVS, to najpierw
musisz skompilować plik WAR poleceniem <tt>ant war</tt>.)</p>
</span><span class="bodytext">

Zakładając, że zainstalowałeś serwer Tomcat jako </span><span class="bodytext"><tt>~/local/tomcat</tt></span><span class="bodytext">, to
plik WAR można zainstalować poleceniami:
</span><span class="bodytext">
<pre style="margin-left: 40px;">rm -rf ~/local/tomcat/webapps/ROOT*
cp nutch*.war ~/local/tomcat/webapps/ROOT.war
</pre>
</span><span class="bodytext">
</span><span class="bodytext">
<p>(UWAGA: Aplikacja Nutch w chwili obecnej wymaga instalacji w kontekście ROOT).</p>
</span><span class="bodytext">
Aplikacja standardowo korzysta z indeks&oacute;w z podkatalogu </span><span class="bodytext"><tt>./segments</tt></span><span class="bodytext">,
względem katalogu z kt&oacute;rego startujemy serwer Tomcat. Jeśli pobierałeś strony z
intranetu poleceniem "crawl" zmień aktualny katalog na ten, gdzie jest wynik pobierania,
w przeciwnym przypadku nie zmieniając aktualnego katalogu wydaj następujące polecenie:
</span><span class="bodytext">
<pre style="margin-left: 40px;">~/local/tomcat/bin/catalina.sh start
</pre>
</span><span class="bodytext">
Następnie odwiedź stronę </span><span class="bodytext"><a href="http://localhost:8080/">http://localhost:8080/</a></span><span class="bodytext">.
Miłej zabawy!

</span>
<br class="br">
<br class="br">
</td>
</tr>
</table>
<table width="635" border="0" cellpadding="0" cellspacing="0">
  
<tr>
    
<td width="140">&nbsp;</td>
    <td width="20">&nbsp;</td>
    <td width="475" align="center">
    <span class="bodytext">
    <a href="http://creativecommons.org/licenses/by/2.0/" rel="license">
      <img src="http://creativecommons.org/images/public/somerights.gif" width="88" height="31" alt="Creative Commons License" border="0">
    </a>
    
<br>
    Except where otherwise noted, <br>this site is licensed under a <a href="http://creativecommons.org/licenses/by/2.0/">Creative Commons
    License</a>.
    <br>
      
<a href="../ca/">ca</a> |
      <a href="../de/">de</a> |
      <a href="../en/">en</a> |
      <a href="../es/">es</a> |
      <a href="../fi/">fi</a> |
      <a href="../fr/">fr</a> |
      <a href="../hu/">hu</a> |
      <a href="../jp/">jp</a> |
      <a href="../ms/">ms</a> |
      <a href="../nl/">nl</a> |
      <a href="../pl/">pl</a> |
      <a href="../pt/">pt</a> |
      <a href="../sv/">sv</a> |
      <a href="../th/">th</a> |
      <a href="../zh/">zh</a>
    
<br>
    
<a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=59548" alt="sf.net" width="0" height="0" border="0"></a>
    </span>
    </td>
  
</tr>
  
<tr>
  
</tr>

</table>
</body>
</html>
